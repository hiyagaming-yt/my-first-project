<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Snake.io 2P</title>
  <style>
    body { margin:0; background:#111; display:flex; justify-content:center; align-items:center; height:100vh; }
    canvas { background:#222; border:4px solid white; }
    h1 { color:white; text-align:center; font-family:sans-serif; }
  </style>
</head>
<body>
  <canvas id="game" width="800" height="600"></canvas>
  <script>
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");

    const grid = 20;
    const speed = 150; // lower = faster

    // Snake class
    class Snake {
      constructor(x, y, color, controls) {
        this.x = x;
        this.y = y;
        this.color = color;
        this.body = [{x:this.x, y:this.y}];
        this.dx = 1; this.dy = 0;
        this.controls = controls;
        this.alive = true;
      }
      draw() {
        ctx.fillStyle = this.color;
        for (let part of this.body) {
          ctx.fillRect(part.x * grid, part.y * grid, grid-2, grid-2);
        }
      }
      move() {
        if (!this.alive) return;
        let head = {x: this.body[0].x + this.dx, y: this.body[0].y + this.dy};
        // Wrap around edges
        if (head.x < 0) head.x = canvas.width / grid - 1;
        if (head.x >= canvas.width / grid) head.x = 0;
        if (head.y < 0) head.y = canvas.height / grid - 1;
        if (head.y >= canvas.height / grid) head.y = 0;
        // Check collision with self
        for (let part of this.body) {
          if (head.x === part.x && head.y === part.y) this.alive = false;
        }
        this.body.unshift(head);
        this.body.pop(); // move forward
      }
      grow() {
        let tail = this.body[this.body.length-1];
        this.body.push({...tail});
      }
    }

    // Controls
    const p1Controls = {up:"w", down:"s", left:"a", right:"d"};
    const p2Controls = {up:"ArrowUp", down:"ArrowDown", left:"ArrowLeft", right:"ArrowRight"};

    const p1 = new Snake(5, 5, "lime", p1Controls);
    const p2 = new Snake(30, 20, "cyan", p2Controls);

    let food = {x: 10, y: 10};

    function spawnFood() {
      food.x = Math.floor(Math.random() * (canvas.width / grid));
      food.y = Math.floor(Math.random() * (canvas.height / grid));
    }

    function drawFood() {
      ctx.fillStyle = "red";
      ctx.fillRect(food.x * grid, food.y * grid, grid-2, grid-2);
    }

    // Controls listener
    document.addEventListener("keydown", e => {
      [p1, p2].forEach(player => {
        if (e.key === player.controls.up && player.dy === 0) {player.dx=0; player.dy=-1;}
        if (e.key === player.controls.down && player.dy === 0) {player.dx=0; player.dy=1;}
        if (e.key === player.controls.left && player.dx === 0) {player.dx=-1; player.dy=0;}
        if (e.key === player.controls.right && player.dx === 0) {player.dx=1; player.dy=0;}
      });
    });

    function update() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Move snakes
      p1.move(); p2.move();

      // Check food eaten
      [p1, p2].forEach(player => {
        if (player.alive && player.body[0].x === food.x && player.body[0].y === food.y) {
          player.grow();
          spawnFood();
        }
      });

      // Draw snakes + food
      drawFood();
      p1.draw(); p2.draw();

      // Draw score
      ctx.fillStyle="white"; ctx.font="20px Arial";
      ctx.fillText(`P1 Length: ${p1.body.length}`, 10, 20);
      ctx.fillText(`P2 Length: ${p2.body.length}`, 650, 20);

      // Game Over check
      if (!p1.alive || !p2.alive) {
        ctx.fillStyle="yellow"; ctx.font="40px Arial";
        if (!p1.alive && !p2.alive) ctx.fillText("Draw!", 340, 300);
        else if (!p1.alive) ctx.fillText("Player 2 Wins!", 280, 300);
        else ctx.fillText("Player 1 Wins!", 280, 300);
        return;
      }

      setTimeout(update, speed);
    }

    spawnFood();
    update();
  </script>
</body>
</html>
